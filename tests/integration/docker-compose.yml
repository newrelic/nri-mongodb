services:

  mongodb:
    image: docker.io/library/mongo:4.4
    environment:
      - MONGO_INITDB_ROOT_USERNAME=root
      - MONGO_INITDB_ROOT_PASSWORD=password123
    ports:
      - "27017:27017"
    volumes:
      - 'mongodb_data:/data/db'
    command: mongod --bind_ip_all --auth

  nri-mongodb:
    container_name: integration_nri-mongodb
    build:
      context: ../../
      dockerfile: tests/integration/Dockerfile
    depends_on: 
      - mongodb

volumes:
  mongodb_data:
    driver: local